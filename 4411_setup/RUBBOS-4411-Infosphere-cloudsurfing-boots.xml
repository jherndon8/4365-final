<?xml version="1.0"?>

<xtbl name="RubbosBenchmark" version="0.1">


<instances>
  <params>
    <env>
      <!-- Experiment name on Emulab -->
      <!--<param name="EMULAB_EXPERIMENT_NAME" value="jkimball1111.infosphere.emulab.net"/>-->
      <param name="EMULAB_EXPERIMENT_NAME" value="FILL IN.infosphere.emulab.net"/>

      <!--<param name="USERNAME" value="jkimball"/>-->
      <param name="USERNAME" value="FILL IN"/>

      <!-- Directories from which files are copied -->

      <!--<param name="WORK_HOME" value="/proj/Infosphere/jkimball/rubbos/rubbos_yasu"/>-->
      <param name="WORK_HOME" value="FILL IN"/>

      <!--<param name="OUTPUT_HOME" value="/proj/Infosphere/jkimball/rubbos/rubbos_yasu/1111test"/>-->
      <param name="OUTPUT_HOME" value="FILL IN"/>

      <!--<param name="DATA_HOME" value="/proj/Infosphere/jkimball/softwares/data"/>-->
      <param name="DATA_HOME" value="FILL IN"/>

      <!--<param name="SOFTWARE_HOME" value="/proj/Infosphere/jhpark/softwares/yasu"/>-->
      <param name="SOFTWARE_HOME" value="/mnt/softwares"/>

      <!-- parameters for customizing an existing image -->
      <param name="EXIST_IMG" value="true"/>
      <param name="GROUPNAME" value="Infosphere"/>

      <!-- Directory names from source code repository containing relevant monitors -->      
      <param name="MSCOPE_EVENT_DIR" value="mScopeEventMonitors"/>
      <param name="MSCOPE_RSRC_DIR" value="mScopeResourceMonitors"/>
      

      <!-- Output directory for results of RUBBoS benchmark -->
      <param name="RUBBOS_RESULTS_HOST" value="jkimball@users.emulab.net"/>
      <param name="RUBBOS_RESULTS_DIR_BASE" value="/proj/Infosphere/jkimball/results"/>
      <param name="RUBBOS_RESULTS_PARSE" value="/project/Infosphere/jkimball/results/1111test"/>

      <!-- Target directories -->
      <param name="ELBA_TOP" value="/mnt/elba"/>
      <param name="RUBBOS_TOP" value="$ELBA_TOP/rubbos"/>
      <param name="TMP_RESULTS_DIR_BASE" value="/mnt/elba/rubbos/results"/>
      <param name="RUBBOS_HOME" value="/mnt/elba/rubbos/RUBBoS"/>
      <param name="SYSSTAT_HOME" value="/mnt/elba/rubbos/sysstat-10.0.5"/>
      <param name="HTTPD_HOME" value="/mnt/elba/rubbos/apache2"/>
      <param name="APR_HOME" value="/mnt/elba/rubbos/apr"/>
      <param name="APR_UTIL_HOME" value="/mnt/elba/rubbos/apr-util"/>
      <param name="LIBEVENT_HOME" value="/mnt/elba/rubbos/libevent"/>
      <param name="MEMCACHED_HOME" value="/mnt/elba/rubbos/memcached"/>
      <param name="HTTPD_INSTALL_FILES" value="$RUBBOS_TOP/httpd-2.2.22"/>
      <param name="MOD_JK_INSTALL_FILES" value="$RUBBOS_TOP/tomcat-connectors-1.2.32-src"/>
      <param name="APR_SRC" value="$RUBBOS_TOP/apr-1.4.6"/>
      <param name="APR_UTIL_SRC" value="$RUBBOS_TOP/apr-util-1.4.1"/>
      <param name="MOD_MEMCACHED_SRC" value="$RUBBOS_TOP/mod_memcached_cache-0.1.0"/>
      <param name="LIBEVENT_SRC" value="$RUBBOS_TOP/libevent-2.0.17-stable"/>
      <param name="MEMCACHED_SRC" value="$RUBBOS_TOP/memcached-1.4.13"/>
      <param name="CATALINA_HOME" value="/mnt/elba/rubbos/apache-tomcat-5.5.17"/>
      <param name="CATALINA_BASE" value="$CATALINA_HOME"/>
      <param name="CJDBC_HOME" value="$RUBBOS_TOP/c-jdbc-2.0.2-bin"/> 
      <param name="MYSQL_HOME" value="$RUBBOS_TOP/mysql-5.5.28-linux2.6-x86_64"/>
<!--  <param name="MYSQL_HOME" value="$RUBBOS_TOP/mysql-5.5.17-linux2.6-x86_64"/> -->
<!--  <param name="POSTGRES_HOME" value="$RUBBOS_TOP/pgsql"/>
      <param name="POSTGRES_INSTALL_FILES" value="$RUBBOS_TOP/postgresql-8.3.1"/> -->
      <param name="JONAS_ROOT" value="$RUBBOS_TOP/JONAS_4_6_6"/>

      <!-- Java & Ant -->
      <param name="JAVA_HOME" value="/mnt/elba/rubbos/jdk1.7.0"/>
      <param name="JAVA_OPTS" value="-Xmx6000m"/>
<!--  <param name="JAVA_OPTS_DB" value="-Xmx160m"/>  -->
      <param name="J2EE_HOME" value="/mnt/elba/rubbos/j2sdkee1.3.1"/>
      <param name="ANT_HOME" value="$RUBBOS_TOP/apache-ant-1.6.5"/>

      <!-- Tarballs -->
      <param name="JAVA_TARBALL" value="jdk-7-linux-x64.tar.gz"/>
      <param name="J2EE_TARBALL" value="j2sdkee1.3.1.jar.gz"/>  
      <param name="ANT_TARBALL" value="apache-ant-1.6.5.tar.gz"/>  
      <param name="SYSSTAT_TARBALL" value="sysstat-10.0.5.tar.gz"/>
      <param name="COLL_TARBALL" value="collectl-4.0.4.src.tar.gz"/> 
      <param name="HTTPD_TARBALL" value="httpd-2.2.22.tar.gz"/>  
      <param name="APR_TARBALL" value="apr-1.4.6.tar.gz"/>
      <param name="APR_UTIL_TARBALL" value="apr-util-1.4.1.tar.gz"/>
      <param name="MOD_MEMCACHED_TARBALL" value="mod_memcached_cache-0.1.0.tar.bz2"/>
      <param name="MOD_JK_TARBALL" value="tomcat-connectors-1.2.32-src.tar.gz"/>
      <param name="LIBEVENT_TARBALL" value="libevent-2.0.17-stable.tar.gz"/>
      <param name="MEMCACHED_TARBALL" value="memcached-1.4.13.tar.gz"/>
      <param name="TOMCAT_TARBALL" value="apache-tomcat-5.5.17.tar.gz"/>
      <param name="CJDBC_TARBALL" value="c-jdbc-2.0.2-bin.tar.gz"/> 
      <param name="MYSQL_TARBALL" value="mysql-5.5.28-linux2.6-x86_64.tar.gz"/>
      <param name="MYSQL_TARBALL_RT" value="mysql-5.0.51a-modified-bin.tar.gz"/>
<!--  <param name="POSTGRES_TARBALL" value="postgresql-8.3.1.tar.gz"/>  -->
      <param name="RUBBOS_TARBALL" value="RUBBoS-benchmark.tar.gz"/>  
      <param name="RUBBOS_DATA_TARBALL" value="rubbos_orig_data.tar.gz"/>  
      <param name="RUBBOS_DATA_TEXTFILES_TARBALL" value="smallDB-rubbos-modified.tgz"/>  

      <!-- for MySQL -->
      <param name="MYSQL_CONNECTOR" value="mysql-connector-java-5.1.19-bin.jar"/>
      <param name="MYSQL_PORT" value="3313"/>
      <param name="MYSQL_SOCKET" value="$MYSQL_HOME/mysql.sock"/> 
      <param name="MYSQL_DATA_DIR" value="$MYSQL_HOME/data"/>
      <param name="MYSQL_ERR_LOG" value="$MYSQL_HOME/data/mysql.log"/>
      <param name="MYSQL_PID_FILE" value="$MYSQL_HOME/run/mysqld.pid"/>
      <param name="MYSQL_ROOT_PW" value="new-password"/>

      <!-- for PostgreSQL 
      <param name="POSTGRES_CONNECTOR" value="postgresql-8.3-603.jdbc3.jar"/>
      <param name="POSTGRES_DATA_DIR" value="$POSTGRES_HOME/data"/> -->

      <!-- for C-JDBC --> 
      <param name="CJDBC_DRIVER" value="c-jdbc-driver.jar"/>
      <param name="CJDBC_CONTROLLER" value="c-jdbc-controller.jar"/>
      <param name="CJDBC_PORT" value="25322"/> 

      <!-- for DBs & C-JDBC -->
      <param name="ROOT_PASSWORD" value="new-password"/>
      <param name="ELBA_USER" value="elba"/>
      <param name="ELBA_PASSWORD" value="elba"/>

    </env>

    <workloads>
      <param name="workload" value="1000"/>
<!--
      <param name="workload" value="5000"/>
      <param name="workload" value="10000"/>
      <param name="workload" value="20000"/>
      <param name="workload" value="30000"/>
      <param name="workload" value="40000"/>
      <param name="workload" value="50000"/>
      <param name="workload" value="60000"/>
      <param name="workload" value="70000"/>
      <param name="workload" value="80000"/>
      <param name="workload" value="90000"/>
-->
    </workloads>

    <rubbos-conf>
      <param name="tpcw_think_time" value="7000"/>
      <param name="connectionPoolSize" value="24"/>
      <param name="upRampTime" value="180000"/>
      <param name="runTime" value="180000"/>
      <param name="downRampTime" value="30000"/>
      <param name="removeBinFiles" value="true"/>
      <param name="MON_FREQUENCY" value="1" />
      <param name="collMonitor" value="true"/>
      <param name="iostatMonitor" value="false"/>
      <param name="psMonitor" value="false"/>
      <param name="sarMonitor" value="false"/>
      <param name="XML_ENABLED" value="false"/>
    </rubbos-conf>

    <apache-conf>
      <param name="Timeout" value="5"/>
      <param name="KeepAlive" value="Off"/>
      <param name="MaxKeepAliveRequests" value="100"/>
      <param name="ServerLimit" value="200"/>
      <param name="ThreadLimit" value="300"/>
      <param name="StartServers" value="1"/>
      <param name="MaxClients" value="300"/>
      <param name="MinSpareThreads" value="5"/>
      <param name="MaxSpareThreads" value="50"/>
      <param name="ThreadsPerChild" value="150"/>
      <param name="MaxRequestsPerChild" value="0"/>
    </apache-conf>

    <tomcat-conf>
      <param name="maxThreads" value="330"/>
      <param name="minSpareThreads" value="5"/>
      <param name="maxSpareThreads" value="50"/>
      <param name="acceptCount" value="6000"/>
    </tomcat-conf>

    <cjdbc-conf>
      <param name="initPoolSize" value="30"/>
      <param name="minPoolSize" value="25"/>
      <param name="maxPoolSize" value="90"/>
      <param name="idleTimeout" value="30"/>
      <param name="waitTimeout" value="10"/>
      <param name="waitForCompletion" value="all"/>
      <!-- "all" or "first", "first" is default" -->
      <!-- <param name="loadBalancing" value="LeastPendingRequestsFirst"/> -->
      <!-- "LeastPendingRequestsFirst" or "RoundRobin", "LeastPendingRequestsFirst" is default" -->
    </cjdbc-conf>
<!--
    <postgres-conf>
      <param name="max_connections" value="150"/>
      <param name="shared_buffers" value="24MB"/>
      <param name="max_fsm_pages" value="153600"/>
      <param name="checkpoint_segments" value="16"/>
    </postgres-conf>
-->
    <logging>
      <param name="apacheResponseTime" value="true"/>
      <param name="tomcatResponseTime" value="true">
         <sampling ratio="100"/>
      </param>
      <param name="cjdbcResponseTime" value="true"/>
      <param name="mysqlResponseTime" value="false"/>
      <param name="mysqlslowquerylog" value="true">
         <long_query time="1"/>
      </param>
<!--
      <param name="apacheResponseTime" value="false"/>
      <param name="tomcatResponseTime" value="false"/>
      <param name="cjdbcResponseTime" value="false"/>
      <param name="mysqlResponseTime" value="false"/>
-->
    </logging>
    
    <qingyang>
<!--
      <param name="qyclient" value="true"/>
-->
      <param name="qyclient" value="false"/>
      <param name="qyservlet" value="false"/>
    </qingyang>
 

  </params>

  <instance name="CONTROL" type="control_server">
    <target>node1</target>
    <action type="checkScp_exec" seq="1" template="../templates/DeployScript/check_scp.xsl" />
    <action type="emulabConf_exec" seq="2" template="../templates/DeployScript/emulab_config.xsl" />
    <action type="customization_exec" seq="5" template="../templates/DeployScript/customization.xsl" />
    <action type="rubbos_exec" seq="250" template="../templates/DeployScript/RUBBOSexecution.xsl" />
  </instance> 
  
  <instance name="BENCHMARK" type="benchmark_server">
    <target>node2</target>
    <action type="rubbos_install" seq="21" template="../templates/DeployScript/RUBBOSinstall.xsl" />
    <action type="install" seq="23" template="../templates/DeployScript/RUBBOS_CLIENTinstall.xsl" />
    <action type="configure" seq="105" template="../templates/DeployScript/RUBBOS_CLIENTconfigure.xsl" />
    <action type="uninstall" seq="401" template="../templates/DeployScript/RUBBOS_CLIENTuninstall.xsl" />
    <action type="rubbos_uninstall" seq="402" template="../templates/DeployScript/RUBBOSuninstall.xsl" />
  </instance> 
  
  <instance name="CLIENT1" type="client_server">
    <target>node3</target>
    <action type="rubbos_install" seq="22" template="../templates/DeployScript/RUBBOSinstall.xsl" />
    <action type="install" seq="24" template="../templates/DeployScript/RUBBOS_CLIENTinstall.xsl" />
    <action type="configure" seq="106" template="../templates/DeployScript/RUBBOS_CLIENTconfigure.xsl" />
    <action type="uninstall" seq="403" template="../templates/DeployScript/RUBBOS_CLIENTuninstall.xsl" />
    <action type="rubbos_uninstall" seq="404" template="../templates/DeployScript/RUBBOSuninstall.xsl" />
  </instance> 
 
  <instance name="CLIENT2" type="client_server">
    <target>node4</target>
    <action type="rubbos_install" seq="22" template="../templates/DeployScript/RUBBOSinstall.xsl" />
    <action type="install" seq="24" template="../templates/DeployScript/RUBBOS_CLIENTinstall.xsl" />
    <action type="configure" seq="106" template="../templates/DeployScript/RUBBOS_CLIENTconfigure.xsl" />
    <action type="uninstall" seq="403" template="../templates/DeployScript/RUBBOS_CLIENTuninstall.xsl" />
    <action type="rubbos_uninstall" seq="404" template="../templates/DeployScript/RUBBOSuninstall.xsl" />
  </instance> 
  
  <instance name="CLIENT3" type="client_server">
    <target>node5</target>
    <action type="rubbos_install" seq="22" template="../templates/DeployScript/RUBBOSinstall.xsl" />
    <action type="install" seq="24" template="../templates/DeployScript/RUBBOS_CLIENTinstall.xsl" />
    <action type="configure" seq="106" template="../templates/DeployScript/RUBBOS_CLIENTconfigure.xsl" />
    <action type="uninstall" seq="403" template="../templates/DeployScript/RUBBOS_CLIENTuninstall.xsl" />
    <action type="rubbos_uninstall" seq="404" template="../templates/DeployScript/RUBBOSuninstall.xsl" />
  </instance> 

  <instance name="CLIENT4" type="client_server">
    <target>node6</target>
    <action type="rubbos_install" seq="22" template="../templates/DeployScript/RUBBOSinstall.xsl" />
    <action type="install" seq="24" template="../templates/DeployScript/RUBBOS_CLIENTinstall.xsl" />
    <action type="configure" seq="106" template="../templates/DeployScript/RUBBOS_CLIENTconfigure.xsl" />
    <action type="uninstall" seq="403" template="../templates/DeployScript/RUBBOS_CLIENTuninstall.xsl" />
    <action type="rubbos_uninstall" seq="404" template="../templates/DeployScript/RUBBOSuninstall.xsl" />
  </instance>

  <instance name="HTTPD" type="web_server">
    <target>node7</target>
    <action type="install" seq="15" template="../templates/DeployScript/WEBinstall.xsl" />
    <action type="rubbos_install" seq="20" template="../templates/DeployScript/RUBBOSinstall.xsl" />
    <action type="configure" seq="104" template="../templates/DeployScript/WEBconfigure.xsl" />
    <action type="ignition" seq="205" template="../templates/DeployScript/WEBignition.xsl" />
    <action type="stop" seq="301" template="../templates/DeployScript/WEBstop.xsl" />
    <action type="rubbos_uninstall" seq="405" template="../templates/DeployScript/RUBBOSuninstall.xsl" />
    <action type="uninstall" seq="406" template="../templates/DeployScript/WEBuninstall.xsl" />
  </instance>

  <instance name="TOMCAT1" type="app_server">
    <target>node8</target>
    <action type="install" seq="13" template="../templates/DeployScript/TOMCATinstall.xsl"/>
    <action type="rubbos_install" seq="18" template="../templates/DeployScript/RUBBOSinstall.xsl" />
    <action type="configure" seq="102" template="../templates/DeployScript/TOMCATconfigure.xsl" />
    <action type="rubbosSL_configure" seq="107" template="../templates/DeployScript/RUBBOS_SERVLETconfigure.xsl" />
    <action type="ignition" seq="203" template="../templates/DeployScript/TOMCATignition.xsl" />
    <action type="stop" seq="303" template="../templates/DeployScript/TOMCATstop.xsl" />
    <action type="rubbos_uninstall" seq="407" template="../templates/DeployScript/RUBBOSuninstall.xsl" />
    <action type="uninstall" seq="408" template="../templates/DeployScript/TOMCATuninstall.xsl" />
  </instance>

<!--
  <instance name="TOMCAT2" type="app_server">
    <target>node9</target>
    <action type="install" seq="13" template="../templates/DeployScript/TOMCATinstall.xsl"/>
    <action type="rubbos_install" seq="18" template="../templates/DeployScript/RUBBOSinstall.xsl" />
    <action type="configure" seq="102" template="../templates/DeployScript/TOMCATconfigure.xsl" />
    <action type="rubbosSL_configure" seq="107" template="../templates/DeployScript/RUBBOS_SERVLETconfigure.xsl" />
    <action type="ignition" seq="203" template="../templates/DeployScript/TOMCATignition.xsl" />
    <action type="stop" seq="303" template="../templates/DeployScript/TOMCATstop.xsl" />
    <action type="rubbos_uninstall" seq="407" template="../templates/DeployScript/RUBBOSuninstall.xsl" />
    <action type="uninstall" seq="408" template="../templates/DeployScript/TOMCATuninstall.xsl" />
  </instance>
-->

  <instance name="CJDBC" type="cjdbc_server">
    <swname>CJDBC_Controller</swname>
    <target>node9</target>
    <action type="install" seq="12" template="../templates/DeployScript/CJDBC_CONTROLLERinstall.xsl" />
    <action type="rubbos_install" seq="17" template="../templates/DeployScript/RUBBOSinstall.xsl" />
    <action type="ignition" seq="202" template="../templates/DeployScript/CJDBC_CONTROLLERignition.xsl" />
    <action type="stop" seq="304" template="../templates/DeployScript/CJDBC_CONTROLLERstop.xsl" />
    <action type="rubbos_uninstall" seq="409" template="../templates/DeployScript/RUBBOSuninstall.xsl" />
    <action type="uninstall" seq="410" template="../templates/DeployScript/CJDBC_CONTROLLERuninstall.xsl" />
  </instance>

  <instance name="MYSQL1" type="db_server">
    <target>node10</target>
    <action type="install" seq="11" template="../templates/DeployScript/MYSQLinstall.xsl" />
    <action type="rubbos_install" seq="16" template="../templates/DeployScript/RUBBOSinstall.xsl" />
    <action type="configure" seq="101" template="../templates/DeployScript/MYSQLconfigure.xsl" />
    <action type="reset" seq="150" template="../templates/DeployScript/MYSQLreset.xsl" />
    <action type="ignition" seq="201" template="../templates/DeployScript/MYSQLignition.xsl" />
    <action type="stop" seq="305" template="../templates/DeployScript/MYSQLstop.xsl" />
    <action type="rubbos_uninstall" seq="411" template="../templates/DeployScript/RUBBOSuninstall.xsl" />
    <action type="uninstall" seq="412" template="../templates/DeployScript/MYSQLuninstall.xsl" />
  </instance>
<!--
  <instance name="MYSQL2" type="db_server">
    <target>node13</target>
    <action type="install" seq="11" template="../templates/DeployScript/MYSQLinstall.xsl" />
    <action type="rubbos_install" seq="16" template="../templates/DeployScript/RUBBOSinstall.xsl" />
    <action type="configure" seq="101" template="../templates/DeployScript/MYSQLconfigure.xsl" />
    <action type="reset" seq="150" template="../templates/DeployScript/MYSQLreset.xsl" />
    <action type="ignition" seq="201" template="../templates/DeployScript/MYSQLignition.xsl" />
    <action type="stop" seq="305" template="../templates/DeployScript/MYSQLstop.xsl" />
    <action type="rubbos_uninstall" seq="411" template="../templates/DeployScript/RUBBOSuninstall.xsl" />
    <action type="uninstall" seq="412" template="../templates/DeployScript/MYSQLuninstall.xsl" />
  </instance>

  <instance name="MONITOR" type="monitor_server">
    <target>node20</target>
    <action type="install" seq="15" template="../templates/DeployScript/WEBinstall.xsl" />
    <action type="rubbos_install" seq="20" template="../templates/DeployScript/RUBBOSinstall.xsl" />
    <action type="configure" seq="104" template="../templates/DeployScript/WEBconfigure.xsl" />
    <action type="ignition" seq="205" template="../templates/DeployScript/WEBignition.xsl" />
    <action type="stop" seq="301" template="../templates/DeployScript/WEBstop.xsl" />
    <action type="rubbos_uninstall" seq="405" template="../templates/DeployScript/RUBBOSuninstall.xsl" />
    <action type="uninstall" seq="406" template="../templates/DeployScript/WEBuninstall.xsl" />
  </instance>
-->
<!--
  <instance name="MEMCACHE1" type="memcache_server">
    <target>node21</target>
    <action type="install" seq="14" template="../templates/DeployScript/MEMCACHEinstall.xsl"/>
    <action type="rubbos_install" seq="19" template="../templates/DeployScript/RUBBOSinstall.xsl" /> -->
<!--    <action type="configure" seq="103" template="../templates/DeployScript/MEMCACHEconfigure.xsl" /> -->
<!--
    <action type="ignition" seq="204" template="../templates/DeployScript/MEMCACHEignition.xsl" />
    <action type="stop" seq="302" template="../templates/DeployScript/MEMCACHEstop.xsl" />
  </instance>
-->
</instances>

</xtbl>


